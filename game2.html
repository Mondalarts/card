<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tic Tac Toe vs Bot</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: radial-gradient(circle at center, #1a1a1a, #000000);
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    #board {
      display: grid;
      grid-template-columns: repeat(3, 120px);
      grid-template-rows: repeat(3, 120px);
      gap: 10px;
    }

    .cell {
      width: 120px;
      height: 120px;
      background: rgba(255,255,255,0.08);
      border: 2px solid rgba(255,255,255,0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 60px;
      font-weight: bold;
      cursor: pointer;
      border-radius: 20px;
      transition: 0.3s;
    }

    .cell:hover {
      transform: scale(1.05);
      background: rgba(255,255,255,0.15);
    }

    .cell.red { color: #ff3b30; text-shadow: 0 0 12px #ff3b30; }
    .cell.blue { color: #0a84ff; text-shadow: 0 0 12px #0a84ff; }

    .status, .timer {
      font-size: 22px;
      font-weight: bold;
      margin-top: 20px;
      text-align: center;
      color: #fff;
      text-shadow: 0 0 8px rgba(255,255,255,0.3);
    }
  </style>
</head>
<body>
  <div id="board"></div>
  <div class="status" id="status">Round 1: Your turn</div>
  <div class="timer" id="timer">Time left: 15</div>

  <script>
    const board = document.getElementById("board");
    const status = document.getElementById("status");
    const timerEl = document.getElementById("timer");
    let cells = [];
    let currentPlayer = "X";
    let botPlayer = "O";
    let round = 1;
    let wins = 0;
    let interval;
    let timeLeft = 15;

    const combos = [
      [0,1,2],[3,4,5],[6,7,8],
      [0,3,6],[1,4,7],[2,5,8],
      [0,4,8],[2,4,6]
    ];

    function createBoard() {
      board.innerHTML = "";
      cells = [];
      for (let i = 0; i < 9; i++) {
        const cell = document.createElement("div");
        cell.classList.add("cell");
        cell.dataset.index = i;
        cell.addEventListener("click", handleClick);
        board.appendChild(cell);
        cells.push(cell);
      }
      startTimer();
    }

    function handleClick(e) {
      const cell = e.target;
      if (cell.textContent !== "") return;
      cell.textContent = currentPlayer;
      cell.classList.add(currentPlayer === "X" ? "red" : "blue");

      if (checkWinner(currentPlayer)) {
        wins++;
        status.textContent = `✅ You won Round ${round}!`;
        clearInterval(interval);
        setTimeout(() => {
          if (wins === 2) {
            alert("🎉 You won 2 rounds! Moving to next game.");
            window.location.href = "game3.html";
          } else {
            round++;
            resetRound();
          }
        }, 1000);
        return;
      }

      if (isDraw()) {
        status.textContent = "🤝 Draw!";
        clearInterval(interval);
        setTimeout(() => {
          round++;
          resetRound();
        }, 1000);
        return;
      }

      botMove();
    }

    function botMove() {
      // 1️⃣ Bot tries to win
      for (let combo of combos) {
        const [a,b,c] = combo;
        const line = [cells[a], cells[b], cells[c]];
        if (line.filter(c => c.textContent === botPlayer).length === 2 &&
            line.filter(c => c.textContent === "").length === 1) {
          makeBotMove(line.find(c => c.textContent === ""));
          return;
        }
      }

      // 2️⃣ Bot blocks player's win
      for (let combo of combos) {
        const [a,b,c] = combo;
        const line = [cells[a], cells[b], cells[c]];
        if (line.filter(c => c.textContent === currentPlayer).length === 2 &&
            line.filter(c => c.textContent === "").length === 1) {
          makeBotMove(line.find(c => c.textContent === ""));
          return;
        }
      }

      // 3️⃣ Take center
      if (cells[4].textContent === "") {
        makeBotMove(cells[4]);
        return;
      }

      // 4️⃣ Take a corner
      const corners = [0,2,6,8].filter(i => cells[i].textContent === "");
      if (corners.length > 0) {
        makeBotMove(cells[corners[Math.floor(Math.random()*corners.length)]]);
        return;
      }

      // 5️⃣ Random move
      let emptyCells = cells.filter(c => c.textContent === "");
      if (emptyCells.length > 0) {
        makeBotMove(emptyCells[Math.floor(Math.random()*emptyCells.length)]);
      }
    }

    function makeBotMove(cell) {
      cell.textContent = botPlayer;
      cell.classList.add(botPlayer === "X" ? "red" : "blue");

      if (checkWinner(botPlayer)) {
        status.textContent = `💀 Bot won Round ${round}`;
        clearInterval(interval);
        setTimeout(() => {
          round++;
          resetRound();
        }, 1000);
      } else if (isDraw()) {
        status.textContent = "🤝 Draw!";
        clearInterval(interval);
        setTimeout(() => {
          round++;
          resetRound();
        }, 1000);
      }
    }

    function isDraw() {
      return cells.every(cell => cell.textContent !== "");
    }

    function checkWinner(player) {
      return combos.some(combo => combo.every(i => cells[i].textContent === player));
    }

    function resetRound() {
      status.textContent = `Round ${round}: Your turn`;
      timeLeft = 15;
      createBoard();
    }

    function startTimer() {
      clearInterval(interval);
      interval = setInterval(() => {
        timeLeft--;
        timerEl.textContent = `Time left: ${timeLeft}`;
        if (timeLeft <= 0) {
          clearInterval(interval);
          status.textContent = "⏰ Time's up! You lost this round.";
          round++;
          setTimeout(resetRound, 1000);
        }
      }, 1000);
    }

    createBoard();
  </script>
</body>
</html>
